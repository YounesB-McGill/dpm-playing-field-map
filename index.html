<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>A Competition Map for DPM</title>
    <link rel="stylesheet" href="bootstrap.min.css"></style>
    <script type="text/javascript" src="jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="bootstrap.min.js"></script>
    <script type="text/javascript" src="vue.min.js"></script>
    <script type="text/javascript" src="xmlToJson.js"></script>

    <script type="text/javascript" src="grid-creator.js"></script>
    <script type="text/javascript" src="playing-field.js"></script>
    
</head>
<body>

<!-- Place this canvas wherever, just make sure to remember its 'id' for the GridCreator -->
<canvas id="competition-field" width="600" height="360" style="border:1px solid #d3d3d3;">
    Your browser does not support the HTML canvas tag.</canvas>


<div id="app" class="container-fluid">
    <!-- Create the input elements -->
    <span class="row ">
        <span class="col-lg-4 col-md-12 my-2">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Competition Map</h5>
                    <p class="card-text">LL is for "Lower Left", and UR is for "Upper Right"</p>
                </div>
            </div>
        </span>
        <span class="col-lg-4 col-sm-6 my-2">
            <div class="card">
                <div class="card-body">
                    <a href="#" class="btn btn-dark border display-block" onclick="numberValueXmlToElements('example-layout.xml');">Load Example Layout</a>
                </div>
            </div>
        </span>
        <span class="col-lg-4 col-sm-6 my-2">
            <div class="card">
                <div class="card-body">
                    <a class="btn btn-light border display-block mb-1">Paste in a Layout</a>
                    <a class="btn btn-light border display-block mb-1" onclick="copyToClipboard(xmlCreator.createValueBasedXML())">Copy Layout to Clipboard</a>
                    <a class="btn btn-light border display-block mb-1">Reset All Values</a>
                </div>
            </div>
        </span>
    </span>

    </span>
    <div class="row"> 
        <team-input v-for="(properties, title) in team_inputs" v-bind:title="title" v-bind:min="properties.min" v-bind:max="properties.max"></team-input>
        <corner-input v-for="(properties, title) in corner_inputs" v-bind:title="title"></corner-input>
    </div>
    <area-input v-for="(properties, title) in area_inputs" v-bind:title="title"></area-input>
    
</div>

</body>
<style>
    .display-block {
        display:block;
    }
    input[type=number]::-webkit-inner-spin-button, 
    input[type=number]::-webkit-outer-spin-button {  
        opacity: 1;
    }
    .border-1 {
        border: 1px solid black;
    }
    canvas {
        margin-left: auto;
        margin-right: auto;
        display:block;
    }
    body {
        width: 100%
    }
    @media only screen and (max-width: 700px){
        canvas {
            width:80%;
        }
    }
</style>
<script type="text/x-template" id="area-input-template">
    <div class="row">
        <span class="col-lg-3 col-sm-6 col-md-6 border" v-for="part in parts">
            <!-- Define the input of tile area coordinates -->
            <label v-bind:for="title+part">{{title+part}}</label>    
            <input class="pl-auto" v-bind:id="title+part" v-bind:name="title+part" type="number" value="0" min="0" max="99" />
        </span>
    </div>
</script>
<script type="text/x-template" id="corner-input-template">
    <div class="col-lg-3 col-sm-6 col-md-6 border">
        <label v-bind:for="title">{{title}}</label>
        <select v-bind:id="title" v-bind:name="title">
            <option v-for="part in parts" v-bind:value="part">{{part}}</option>
        </select>
    </div>
</script>
<script type="text/x-template" id="team-input-template">
    <div class="col-lg-3 col-sm-6 col-md-6 border">
        <label v-bind:for="title">{{title}}</label>
        <input v-bind:id="title" v-bind:name="title" type="number" value="1" v-bind:min="min" v-bind:max="max" />
    </div>
</script>
<script>
// Define a new component called area-input
Vue.component('area-input', {
    props: ['title'],
    template: '#area-input-template',
    data: function () {
        return {
            parts: ["_LL_x","_LL_y","_UR_x","_UR_y"]
        }
    }
})
Vue.component('corner-input', {
    props: ['title'],
    template: '#corner-input-template',
    data: function () {
        return {
            parts: [0,1,2,3]
        }
    }
})
Vue.component('team-input', {
    props: ['title','min','max'],
    template: '#team-input-template',
    data: function () {
        return {
        }
    }
})
let playingField = new GridCreator("competition-field",15,9,2);
let xmlCreator = new XMLCreator();
let app = new Vue({
    el: '#app',
    data: {
        title:"area1",
        parts: ["_LL_x","_LL_y","_UR_x","_UR_y"],
        team_inputs:  {"RedTeam":{"color":"red", "min":1, "max":199},"GreenTeam":{"color":"green", "min":1, "max":199}},
        corner_inputs:{"RedCorner":{"color":"red"},"GreenCorner":{"color":"green"}},
        area_inputs:  {
            "Red":{"color":"red"},
            "Green":{"color":"green"},
            "Orange":{"color":"orange"},
            "Island":{"color":"yellow"},
            "TNR":{"color":"purple"},
            "TNG":{"color":"blue"},
            "SZR":{"color":"red"},
            "SZG":{"color":"green"}
        }
    },
    mounted: function () {
        let this_1 = this;
        this.$nextTick(function () {
            let area_parts = ["_LL_x","_LL_y","_UR_x","_UR_y"];
            for (let team_input in this_1.team_inputs) {
                xmlCreator.addElementId(team_input);
            }
            for (let corner_input in this_1.corner_inputs) {
                playingField.addPointIdentifier(corner_input, this_1.corner_inputs[corner_input].color);
                xmlCreator.addElementId(corner_input);
            }
            for (let area_input in this_1.area_inputs) {
                playingField.addAreaIdentifier(area_input, this_1.area_inputs[area_input].color);
                for (let i = 0; i < area_parts.length; i++){
                    xmlCreator.addElementId(area_input + area_parts[i]);
                }
            }
        })
    }
});



// Adding new corner markers
// playingField.addPointIdentifier("RedCorner","red");
// playingField.addPointIdentifier("GreenCorner","green");

// Adding new areas, using 'id'
// playingField.addAreaIdentifier("Red","red");
// playingField.addAreaIdentifier("Green","green");
// playingField.addAreaIdentifier("Island","yellow");
// playingField.addAreaIdentifier("TNR","purple");
// playingField.addAreaIdentifier("TNG","blue");
// playingField.addAreaIdentifier("SZR","red");
// playingField.addAreaIdentifier("SZG","green");

// Just a continuously running function to update the tiles
setInterval(function() {
    playingField.updateCanvas();
}, 200);
</script>
</html>